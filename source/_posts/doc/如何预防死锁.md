---
title: 如何预防死锁
category: 文档
tag: 总结
date: 2024-02-14 17:00:00
abbrlink: 23
---
## 如何预防死锁 

首先举个例子说明什么是死锁，比如，一个十字路口，东西南北四个方向分别有四列车ABCD，A在东向被D堵着，D北被B堵着，B在西被C堵着，C在南被A堵着，这就造成了十字路口的堵死，也就是所谓的死锁。

具体图示如下：

![deadlock](/img/images/deadlock.png)

那么如何预防死锁？

1. 死锁发生的四个必要条件:
   1. 互斥条件 同一时间只能有一个线程获取资源。
   1. 不可剥夺条件 一个线程已经占有的资源，在释放之前不会被其它线程抢占
   1. 请求和保持条件 线程等待过程中不会释放已占有的资源
   1. 循环等待条件 多个线程互相等待对方释放资源
2. 死锁预防，那么就是需要破坏这四个必要条件
   1. 由于资源互斥是资源使用的固有特性，无法改变，我们不讨论
   1. 破坏不可剥夺条件
      1. 一个进程不能获得所需要的全部资源时便处于等待状态，等待期间他占有的资源将被隐式的释放重新加入到系统的资源列表中，可以被其他的进程使用，而等待的进程只有重新获得自己原有的资源以及新申请的资源才可以重新启动，执行
   1. 破坏请求与保持条件
      1. 第一种方法静态分配即每个进程在开始执行时就申请他所需要的全部资源	
      1. 第二种是动态分配即每个进程在申请所需要的资源时他本身不占用系统资源
   1. 破坏循环等待条件
      1. 采用资源有序分配其基本思想是将系统中的所有资源顺序编号，将紧缺的，稀少的采用较大的编号，在申请资源时必须按照编号的顺序进行，一个进程只有获得较小编号的进程才能申请较大编号的进程。