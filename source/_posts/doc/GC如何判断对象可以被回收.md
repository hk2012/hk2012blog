---
title: GC如何判断对象可以被回收
category: 文档
tag: 总结
date: 2024-02-14 07:00:00
abbrlink: 2
---
# GC如何判断对象可以被回收

## 引用计数法（已被淘汰的算法）

1. 每一个对象有一个引用属性，新增一个引用时加一，引用释放时减一，计数为0的时候可以回收。但是这种计算方法，有一个致命的问题，无法解决循环引用的问题

## 可达性分析算法（根引用）

1. 从GcRoot开始向下搜索，搜索所走过的路径被称为引用链，当一个对象到GcRoot没有任何引用链相连时，则证明此对象是不可用的，那么虚拟机就可以判定回收。
1. 那么GcRoot有哪些？
   1. 虚拟机栈中引用的对象
   1. 方法区中静态属性引用的对象
   1. 方法区中常量引用的对象
   1. 本地方法栈中（即一般说的native方法）引用的对象



## 不同的引用类型

1. 不同的引用类型的回收机制是不一样的
   1. 强引用：通过关键字new的对象就是强引用对象，强引用指向的对象任何时候都不会被回收，宁愿OOM也不会回收
   1. 软引用：如果一个对象持有软引用，那么当JVM堆空间不足时，会被回收。一个类的软引用可以通过java.lang.ref.SoftReference持有
   1. 弱引用：如果一个对象持有弱引用，那么在GC时，只要发现弱引用对象，就会被回收。一个类的弱引用可以通过java.lang.ref.WeakReference持有
   1. 虚引用：几乎和没有一样，随时可以被回收。通过ava.lang.ref.PhantomReference持有

