---
title: MySQL 知识总结
category: 笔记
tag: 总结
abbrlink: 15541
date: 2024-05-14 11:10:00
---

# 索引

## 数据库索引的定义和作用
- 定义： 索引（Index） 是数据库管理系统中的一种数据结构，它以特定的方式存储数据表中的某些字段（列）的信息，以加快数据检索的速度。索引类似于书籍的目录，通过它可以快速找到所需的信息，而无需扫描整个表。

- 作用：

    1. 提高查询速度：索引大大加快了 SELECT 查询的速度，尤其是对大表的查询。例如，搜索、排序和分组操作可以显著受益于索引。
    2. 提高数据的检索效率：通过减少磁盘I/O操作，索引能有效提升数据检索的效率。
    3. 强制唯一性：唯一索引（Unique Index）可以确保表中某列的值是唯一的，帮助维持数据的完整性。
    4. 加快表连接速度：在进行表连接（JOIN）操作时，索引能够加速连接操作。
    5. 提升排序和分组性能：在执行 ORDER BY 和 GROUP BY 语句时，索引能够加速这些操作。

- 索引的类型
    1. 主键索引（Primary Key Index）：
        - 唯一标识表中的记录，不允许空值。每个表只能有一个主键索引。
    2. 唯一索引（Unique Index）：
        - 保证索引列的所有值是唯一的，可以有空值。一个表可以有多个唯一索引。
    3. 普通索引（普通索引/Non-Unique Index）：
        - 最基本的索引类型，不强制唯一性，允许重复值。
    4. 复合索引（Composite Index/多列索引）：
        - 包含多个列的索引，通过组合多个列来创建索引，提高组合查询的效率。
    5. 全文索引（Full-Text Index）：
        - 用于全文搜索，适合大文本字段的搜索。支持 MATCH AGAINST 操作。
    6. 空间索引（Spatial Index）：
        - 用于地理空间数据类型的索引，适用于空间数据的快速查询（如点、线、多边形等）。
    7. 哈希索引（Hash Index）：
        - 使用哈希表实现的索引，适用于等值查询，不适用于范围查询。主要用于 Memory 引擎表。
    8. 聚簇索引（Clustered Index）：
        - 数据行的物理顺序与索引的逻辑顺序一致。InnoDB 存储引擎的主键索引就是一种聚簇索引。
    9. 非聚簇索引（Non-Clustered Index）：
        - 索引顺序与数据行的物理顺序无关，每个索引项指向实际数据行的位置。MyISAM 引擎中的索引是非聚簇索引。

- 索引的基础知识回顾
    1. 创建索引：使用 CREATE INDEX 语句来创建普通索引和唯一索引，使用 ALTER TABLE 来创建主键索引。
    2. 删除索引：使用 DROP INDEX 语句。
    3. 查看索引：使用 SHOW INDEX FROM table_name 或 EXPLAIN 语句来查看表的索引情况。
    4. 优化查询：通过分析和调整索引，可以显著优化查询性能。
    5. 理解和使用索引是数据库优化的重要环节，可以显著提升数据库系统的性能。

## 索引失效
- 在MySQL中，索引能够显著提高查询的效率，但在某些情况下，索引可能会失效，从而导致查询性能下降。以下是一些常见的MySQL索引失效场景及其原因：

    1. 使用函数或操作符：
        - 在查询条件中对索引列使用函数（如 LEFT(column, 3) = 'abc'）或操作符（如 column + 1 = 5）会导致索引失效，因为MySQL无法对函数或操作符的结果进行索引。
    2. 类型不匹配：
        - 如果查询条件中的数据类型与索引列的数据类型不匹配，索引可能会失效。例如，索引列是字符串类型，但在查询中使用了数值类型的条件。
    3. 隐式转换：
    类似于类型不匹配，如果MySQL需要对索引列进行隐式转换（如将字符串转换为数值），索引也会失效。
    4. 前导通配符：
        - 使用 LIKE 查询时，如果在通配符 % 或 _ 之前没有任何字符（如 LIKE '%abc'），索引将无法使用。这是因为MySQL无法确定从哪里开始扫描索引。
    5. 不符合最左前缀原则：
        - 对于复合索引，如果查询条件不符合最左前缀原则，索引将失效。例如，复合索引 (a, b, c)，查询条件必须从 a 开始，如 (a, b) 或 (a)，而不能仅使用 b 或 c。
    6. OR条件：
        - 在查询中使用 OR 条件，如果每个条件字段上没有独立的索引，索引会失效。例如，WHERE column1 = value1 OR column2 = value2，只有在 column1 和 column2 上都有独立索引时，索引才会生效。
    7. 范围查询影响后续列：
        - 在复合索引中，如果其中一个列使用了范围查询（如 BETWEEN、<、>），则该列之后的索引列将无法使用。例如，复合索引 (a, b)，查询 WHERE a > 5 AND b = 10 中，索引 b 将失效。
    8. NULL值判断：
        - 对于索引列的 IS NULL 或 IS NOT NULL 判断，MySQL通常不会使用索引，因为NULL值在索引中的处理有特殊情况。
    9. 表扫描：
        - 在某些情况下，即使存在索引，MySQL优化器也可能选择进行全表扫描（Table Scan），例如当表非常小，或统计信息显示使用索引的代价更高时。
    
    - 通过注意上述这些情况，可以有效避免MySQL索引失效，确保查询性能的优化。在实际应用中，使用 EXPLAIN 语句可以帮助检查查询是否使用了索引，并进一步优化查询